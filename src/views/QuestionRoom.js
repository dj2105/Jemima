import { state, recordAnswer } from "../state.js"; import { ScoreStrip } from "../components/ScoreStrip.js"; import { RoleBadge } from "../components/RoleBadge.js"; import { advanceToMarking } from "../flow.js";
export function QuestionRoom(){ const r=state.currentRound||1; const qs=state[`round${r}Questions`]||[]; const root=document.createElement("div"); root.className="wrap"; root.appendChild(ScoreStrip()); root.appendChild(RoleBadge()); const body=document.createElement("div"); body.innerHTML=`<div class="h1">Round ${r}</div>`; qs.forEach(q=>{ const card=document.createElement("div"); card.className="panel"; card.innerHTML=`<div class="p" style="font-weight:700">${q.question}</div>`; const row=document.createElement("div"); row.className="choice-row"; row.dataset.qid=q.id; q.options.forEach((opt,idx)=>{ const b=document.createElement("div"); b.className="choice"; b.textContent=opt; b.addEventListener("click",()=>{ row.querySelectorAll(".choice").forEach(c=>c.classList.remove("selected")); b.classList.add("selected"); recordAnswer(q.id,idx); checkReady(); }); row.appendChild(b); }); card.appendChild(row); body.appendChild(card); }); const go=document.createElement("div"); go.className="row"; go.innerHTML=`<button id="go" class="btn right" disabled>GO</button>`; body.appendChild(go); root.appendChild(body); function checkReady(){ const answered=qs.every(q=>state.answers[state.self][q.id]!==undefined); const g=root.querySelector("#go"); g.disabled=!answered; if(answered) g.classList.add("primary"); } root.querySelector("#go").addEventListener("click",()=>{ advanceToMarking(); }); return root; }